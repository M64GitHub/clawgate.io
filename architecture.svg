<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 880 520" font-family="'DM Sans', -apple-system, BlinkMacSystemFont, sans-serif">
  <defs>
    <linearGradient id="tunnelGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#e07a3a;stop-opacity:0.15"/>
      <stop offset="50%" style="stop-color:#e07a3a;stop-opacity:0.08"/>
      <stop offset="100%" style="stop-color:#e07a3a;stop-opacity:0.15"/>
    </linearGradient>
    <filter id="glow">
      <feGaussianBlur stdDeviation="2" result="blur"/>
      <feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge>
    </filter>
  </defs>

  <!-- Background -->
  <rect width="880" height="520" rx="12" fill="#12141c"/>

  <!-- Tunnel background -->
  <rect x="340" y="60" width="200" height="400" rx="8" fill="url(#tunnelGrad)"/>

  <!-- ==================== LEFT SIDE: AGENT ==================== -->

  <!-- Agent box -->
  <rect x="30" y="70" width="290" height="380" rx="10" fill="#1a1d28" stroke="rgba(255,255,255,0.08)" stroke-width="1"/>
  <text x="175" y="100" text-anchor="middle" fill="#9ca3b4" font-size="11" font-weight="600" letter-spacing="0.08em">ISOLATED MACHINE</text>

  <!-- AI Agent -->
  <rect x="55" y="125" width="240" height="60" rx="8" fill="#1f2330" stroke="rgba(255,255,255,0.06)" stroke-width="1"/>
  <text x="100" y="153" fill="#e8eaf0" font-size="13" font-weight="600">AI Agent</text>
  <text x="100" y="170" fill="#6b7280" font-size="10">OpenClaw Â· Claude Code Â· Cursor Â· ...</text>
  <!-- Agent icon -->
  <circle cx="75" cy="155" r="12" fill="rgba(224,122,58,0.12)" stroke="rgba(224,122,58,0.3)" stroke-width="1"/>
  <text x="75" y="159" text-anchor="middle" fill="#e07a3a" font-size="11">ğŸ¤–</text>

  <!-- Arrow: Agent â†’ Agent Daemon -->
  <line x1="175" y1="185" x2="175" y2="205" stroke="#6b7280" stroke-width="1" stroke-dasharray="3,3"/>
  <text x="195" y="199" fill="#6b7280" font-size="9">Unix socket</text>

  <!-- Agent Daemon -->
  <rect x="55" y="208" width="240" height="55" rx="8" fill="#1f2330" stroke="rgba(224,122,58,0.2)" stroke-width="1"/>
  <text x="100" y="233" fill="#e07a3a" font-size="12" font-weight="600">Agent Daemon</text>
  <text x="100" y="250" fill="#6b7280" font-size="10">Token store Â· Request proxy</text>
  <!-- Shield icon -->
  <circle cx="75" cy="235" r="12" fill="rgba(224,122,58,0.12)" stroke="rgba(224,122,58,0.3)" stroke-width="1"/>
  <text x="75" y="239" text-anchor="middle" fill="#e07a3a" font-size="11">ğŸ›¡</text>

  <!-- Operations the agent can do -->
  <rect x="55" y="285" width="240" height="90" rx="8" fill="#161922" stroke="rgba(255,255,255,0.06)" stroke-width="1"/>
  <text x="175" y="306" text-anchor="middle" fill="#9ca3b4" font-size="10" font-weight="600" letter-spacing="0.06em">AGENT COMMANDS</text>

  <text x="72" y="325" fill="#34d399" font-family="'JetBrains Mono', monospace" font-size="9.5">clawgate cat</text>
  <text x="175" y="325" fill="#34d399" font-family="'JetBrains Mono', monospace" font-size="9.5">clawgate ls</text>
  <text x="72" y="342" fill="#60a5fa" font-family="'JetBrains Mono', monospace" font-size="9.5">clawgate git</text>
  <text x="175" y="342" fill="#60a5fa" font-family="'JetBrains Mono', monospace" font-size="9.5">clawgate write</text>
  <text x="72" y="359" fill="#fbbf24" font-family="'JetBrains Mono', monospace" font-size="9.5">clawgate tool</text>
  <text x="175" y="359" fill="#fbbf24" font-family="'JetBrains Mono', monospace" font-size="9.5">clawgate stat</text>

  <!-- MCP label -->
  <rect x="55" y="395" width="240" height="35" rx="6" fill="#161922" stroke="rgba(255,255,255,0.06)" stroke-width="1"/>
  <text x="175" y="417" text-anchor="middle" fill="#6b7280" font-size="10">MCP Server (optional) Â· stdio interface</text>

  <!-- ==================== CENTER: TUNNEL ==================== -->

  <!-- Encrypted tunnel -->
  <rect x="355" y="215" width="170" height="42" rx="6" fill="rgba(224,122,58,0.08)" stroke="rgba(224,122,58,0.25)" stroke-width="1"/>
  <text x="440" y="234" text-anchor="middle" fill="#e07a3a" font-size="10" font-weight="600">E2E Encrypted Tunnel</text>
  <text x="440" y="248" text-anchor="middle" fill="#9ca3b4" font-size="9">X25519 + XChaCha20-Poly1305</text>

  <!-- Arrows through tunnel -->
  <line x1="320" y1="236" x2="355" y2="236" stroke="#e07a3a" stroke-width="1.5" filter="url(#glow)"/>
  <polygon points="353,232 360,236 353,240" fill="#e07a3a"/>

  <line x1="525" y1="236" x2="560" y2="236" stroke="#e07a3a" stroke-width="1.5" filter="url(#glow)"/>
  <polygon points="557,232 564,236 557,240" fill="#e07a3a"/>

  <!-- Port label -->
  <text x="440" y="278" text-anchor="middle" fill="#6b7280" font-size="9">TCP :4223</text>

  <!-- Validation gates (center) -->
  <rect x="370" y="295" width="140" height="135" rx="6" fill="rgba(255,255,255,0.02)" stroke="rgba(255,255,255,0.06)" stroke-width="1"/>
  <text x="440" y="314" text-anchor="middle" fill="#9ca3b4" font-size="10" font-weight="600" letter-spacing="0.05em">VALIDATION GATES</text>

  <text x="385" y="336" fill="#34d399" font-size="9">âœ“</text>
  <text x="398" y="336" fill="#9ca3b4" font-size="9.5">Signature check</text>

  <text x="385" y="354" fill="#34d399" font-size="9">âœ“</text>
  <text x="398" y="354" fill="#9ca3b4" font-size="9.5">Token expiry</text>

  <text x="385" y="372" fill="#34d399" font-size="9">âœ“</text>
  <text x="398" y="372" fill="#9ca3b4" font-size="9.5">Revocation list</text>

  <text x="385" y="390" fill="#34d399" font-size="9">âœ“</text>
  <text x="398" y="390" fill="#9ca3b4" font-size="9.5">Scope validation</text>

  <text x="385" y="408" fill="#34d399" font-size="9">âœ“</text>
  <text x="398" y="408" fill="#9ca3b4" font-size="9.5">Argument allowlist</text>

  <text x="385" y="426" fill="#34d399" font-size="9">âœ“</text>
  <text x="398" y="426" fill="#9ca3b4" font-size="9.5">Forbidden paths</text>

  <!-- ==================== RIGHT SIDE: RESOURCE ==================== -->

  <!-- Resource box -->
  <rect x="560" y="70" width="290" height="380" rx="10" fill="#1a1d28" stroke="rgba(255,255,255,0.08)" stroke-width="1"/>
  <text x="705" y="100" text-anchor="middle" fill="#9ca3b4" font-size="11" font-weight="600" letter-spacing="0.08em">YOUR MACHINE</text>

  <!-- Resource Daemon -->
  <rect x="585" y="125" width="240" height="55" rx="8" fill="#1f2330" stroke="rgba(224,122,58,0.2)" stroke-width="1"/>
  <text x="630" y="150" fill="#e07a3a" font-size="12" font-weight="600">Resource Daemon</text>
  <text x="630" y="167" fill="#6b7280" font-size="10">Validates Â· Executes Â· Audits</text>
  <!-- Shield icon -->
  <circle cx="605" cy="152" r="12" fill="rgba(224,122,58,0.12)" stroke="rgba(224,122,58,0.3)" stroke-width="1"/>
  <text x="605" y="156" text-anchor="middle" fill="#e07a3a" font-size="11">ğŸ›¡</text>

  <!-- Arrow: Daemon â†’ Resources -->
  <line x1="705" y1="180" x2="705" y2="200" stroke="#6b7280" stroke-width="1" stroke-dasharray="3,3"/>

  <!-- Protected resources -->
  <!-- Files -->
  <rect x="585" y="205" width="115" height="52" rx="6" fill="#161922" stroke="rgba(52,211,153,0.2)" stroke-width="1"/>
  <text x="642" y="228" text-anchor="middle" fill="#34d399" font-size="11" font-weight="600">ğŸ“ Files</text>
  <text x="642" y="245" text-anchor="middle" fill="#6b7280" font-size="9">read Â· write Â· stat</text>

  <!-- Git -->
  <rect x="710" y="205" width="115" height="52" rx="6" fill="#161922" stroke="rgba(96,165,250,0.2)" stroke-width="1"/>
  <text x="767" y="228" text-anchor="middle" fill="#60a5fa" font-size="11" font-weight="600">â‡ Git</text>
  <text x="767" y="245" text-anchor="middle" fill="#6b7280" font-size="9">3-tier allowlists</text>

  <!-- Tools -->
  <rect x="585" y="267" width="240" height="52" rx="6" fill="#161922" stroke="rgba(251,191,36,0.2)" stroke-width="1"/>
  <text x="705" y="290" text-anchor="middle" fill="#fbbf24" font-size="11" font-weight="600">âš™ Registered Tools</text>
  <text x="705" y="307" text-anchor="middle" fill="#6b7280" font-size="9">Any CLI tool Â· argument validation Â· output limits</text>

  <!-- Forbidden paths -->
  <rect x="585" y="335" width="240" height="40" rx="6" fill="rgba(248,113,113,0.06)" stroke="rgba(248,113,113,0.15)" stroke-width="1"/>
  <text x="605" y="357" fill="#f87171" font-size="9">ğŸš«</text>
  <text x="622" y="358" fill="#f87171" font-family="'JetBrains Mono', monospace" font-size="9">~/.ssh  ~/.aws  ~/.gnupg</text>
  <text x="807" y="358" fill="#6b7280" font-size="9">blocked</text>

  <!-- Audit log -->
  <rect x="585" y="390" width="240" height="42" rx="6" fill="#161922" stroke="rgba(255,255,255,0.06)" stroke-width="1"/>
  <text x="705" y="410" text-anchor="middle" fill="#9ca3b4" font-size="10" font-weight="500">ğŸ“‹ Audit Log</text>
  <text x="705" y="424" text-anchor="middle" fill="#6b7280" font-size="9">Every operation Â· path Â· tool Â· result</text>

  <!-- ==================== BOTTOM LABELS ==================== -->
  <text x="175" y="475" text-anchor="middle" fill="#6b7280" font-size="10" font-style="italic">Agent never touches your filesystem</text>
  <text x="705" y="475" text-anchor="middle" fill="#6b7280" font-size="10" font-style="italic">Only validated requests reach resources</text>

  <!-- Title -->
  <text x="440" y="500" text-anchor="middle" fill="#e07a3a" font-size="11" font-weight="600" letter-spacing="0.05em">CLAWGATE ARCHITECTURE Â· v0.3</text>
</svg>
